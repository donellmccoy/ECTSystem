@inherits LayoutComponentBase
@inject NavigationManager NavigationManager

<RadzenComponents />
<RadzenLayout Style="min-height: 100vh;">
    <AppHeader OnSidebarToggle="@(() => _sidebarExpanded = !_sidebarExpanded)" />
    
    <RadzenSidebar @bind-Expanded="@_sidebarExpanded" Style="width: 260px; padding: 1rem 0.5rem;">
        <RadzenPanelMenu Style="padding: 0;">
            <RadzenPanelMenuItem Text="Line Of Duty" Icon="folder" Path="/lod/my-lods" Selected="@IsSelected("/lod")" Style="margin-bottom: 0.25rem; border-radius: 8px;" />
            <RadzenPanelMenuItem Text="Special Cases" Icon="star" Path="/special-cases/my-special-cases" Selected="@IsSelected("/special-cases")" Style="margin-bottom: 0.25rem; border-radius: 8px;" />
            <RadzenPanelMenuItem Text="Other Cases" Icon="folder_special" Path="/wwd/my-wwds" Selected="@IsSelected("/other-cases")" Style="margin-bottom: 0.25rem; border-radius: 8px;" />
            <RadzenPanelMenuItem Text="Reports" Icon="assessment" Path="/reports/ad-hoc-reporting" Selected="@IsSelected("/reports")" Style="margin-bottom: 0.25rem; border-radius: 8px;" />
            <RadzenPanelMenuItem Text="Administration" Icon="admin_panel_settings" Path="/administration/create/add-member" Selected="@IsSelected("/administration")" Style="margin-bottom: 0.25rem; border-radius: 8px;" />
            <RadzenPanelMenuItem Text="Help" Icon="help" Path="/help/select-account" Selected="@IsSelected("/help")" Style="border-radius: 8px;" />
        </RadzenPanelMenu>
    </RadzenSidebar>
    
    <RadzenBody Style="background: var(--rz-base-100, #f8f9fa);">
        <div style="padding: 1.5rem 2rem; max-width: 1600px; margin: 0 auto;">
            @Body
        </div>
    </RadzenBody>
    
    <RadzenFooter Style="border-top: 1px solid var(--rz-base-300, #dee2e6);">
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.SpaceBetween" Style="padding: 1rem 2rem;">
            <RadzenText TextStyle="TextStyle.Caption" Style="color: var(--rz-text-tertiary-color, #6c757d);">© @DateTime.Now.Year Electronic Case Tracking System</RadzenText>
            <RadzenStack Orientation="Orientation.Horizontal" Gap="1.5rem" AlignItems="AlignItems.Center">
                <RadzenLink Path="/help/my-account" Text="Help" Style="font-size: 0.875rem;" />
                <RadzenLink Path="/common/about" Text="About" Style="font-size: 0.875rem;" />
                <RadzenText TextStyle="TextStyle.Caption" Style="color: var(--rz-text-tertiary-color, #6c757d);">Version 2.0.0</RadzenText>
            </RadzenStack>
        </RadzenStack>
    </RadzenFooter>
</RadzenLayout>

@code {
    private bool _sidebarExpanded = true;

    private bool IsSelected(string path)
    {
        var currentPath = "/" + NavigationManager.ToBaseRelativePath(NavigationManager.Uri);
        return currentPath.StartsWith(path, StringComparison.OrdinalIgnoreCase);
    }
}
